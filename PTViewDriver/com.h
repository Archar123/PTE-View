#pragma once
#include "util.h"
#include "undocumented.h"

#define IOCTL_DIRBASE (ULONG)CTL_CODE(0x8000, 0x800, METHOD_NEITHER, FILE_ANY_ACCESS)
#define IOCTL_DUMP_PT (ULONG)CTL_CODE(0x8000, 0x801, METHOD_NEITHER, FILE_ANY_ACCESS)
#define IOCTL_DUMP_PAGE (ULONG)CTL_CODE(0x8000, 0x802, METHOD_NEITHER, FILE_ANY_ACCESS)
#define IOCTL_DUMP_LARGE_PAGE (ULONG)CTL_CODE(0x8000, 0x803, METHOD_NEITHER, FILE_ANY_ACCESS)

NTSTATUS SetupDevice(PDRIVER_OBJECT driverObject, PDRIVER_DISPATCH ioHandler);
